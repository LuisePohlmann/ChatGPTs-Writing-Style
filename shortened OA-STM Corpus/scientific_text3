Generalized Macdonald-Ruijsenaars systems  Abstract We consider the polynomial representation of Double Affine Hecke Algebras (DAHAs) and construct its submodules as ideals of functions vanishing on the special collections of affine planes. This generalizes certain results of Kasatani in types An, (Cn∨,Cn). We obtain commutative algebras of difference operators given by the action of invariant combinations of Cherednik-Dunkl operators in the corresponding quotient modules of the polynomial representation. This gives known and new generalized Macdonald-Ruijsenaars systems. Thus in the cases of DAHAs of types An and (Cn∨,Cn) we derive Chalykh-Sergeev-Veselov operators and a generalization of the Koornwinder operator respectively, together with complete sets of quantum integrals in the explicit form.  Introduction The main goal of this paper is to obtain commutative algebras of difference operators containing generalizations of Macdonald-Ruijsenaars operators using special representations of Double Affine Hecke Algebras (DAHAs). In the work [27] the Macdonald-Ruijsenaars operator related to the root system R=AN-1 appeared as the relativistic version of quantum Calogero-Moser system, this operator has the form(1.1)H=∑i=1N∏j=1j≠iNexi-exj+ηexi-exjTxiℏ, where Txiℏ=eℏ∂xi is the shift operator and η,ℏ are parameters. Macdonald derived and considered operator (1.1) and its generalizations for any root system and (quasi-)minuscule coweight in the context of multi-variable orthogonal polynomials [25]. Commutative algebras of difference operators containing the operators constructed by Macdonald were realized by Cherednik with the help of his DAHA and its polynomial representation [5,8]. These algebras are centralizers of the Macdonald-Ruijsenaars operators in the algebras of Weyl-invariant difference operators [22]. The whole area of DAHA is a very rich mathematical subject with deep connections and interactions with combinatorics, theory of (quantum) symmetric spaces, representation theory, noncommutative geometry [9]. The first generalization of the Macdonald-Ruijsenaars operator which is not directly associated to a root system was found by Chalykh [2]. The operator is a difference version of the Hamiltonian which describes interaction of the system of Calogero-Moser particles of two possible masses [4]. The approach of [2] (see also [3]) is based on the multidimensional Baker-Akhiezer functions, in this case all but one particles have equal masses. The generalization of Chalykhʼs operator to the system of N1+N2 particles of two types was introduced by Sergeev and Veselov [29], the corresponding operator has the form(1.2)HN1,N2=∑i=1N1∏j=1j≠iN1exi-exj+ηexi-exj∏ℓ=1N2exi-eyℓ+ℏexi-eyℓTxiℏ+eℏ-1eη-1∑ℓ=1N2∏i=1N1eyℓ-exi+ηeyℓ-exi∏m=1m≠ℓN2eyℓ-eym+ℏeyℓ-eymTyℓη. In the work [29] the operator (1.2) was obtained from the action of the Macdonald-Ruijsenaars operator (1.1) extended to the space of symmetric functions in the infinite number of variables with subsequent restriction of the operator (1.1) to the special discriminant subvariety. Further rational generalized Macdonald-Ruijsenaars operators were derived in [12,30] starting from the generalized Calogero-Moser systems and using the bispectrality. In the present work we develop a uniform approach to the generalized Macdonald-Ruijsenaars systems based on the special representations of DAHAs. DAHA can be associated to any affine root system [25]. The main cases are DAHA of type Rˆ and of type Rˆ∨ where R is a reduced irreducible root system, Rˆ is its affinization and Rˆ∨ denotes the dual affine root system (see Cherednikʼs papers [7] and [5] respectively), and DAHA of type (Cn∨,Cn) (see [26,28]). The original Cherednikʼs construction [5,7] allowed to obtain Macdonald-Ruijsenaars systems for any root system R from the polynomial representation of the corresponding DAHA. The difference operators from the commutative algebra are obtained by the averaging of the Cherednik-Dunkl operators over the Weyl group with subsequent restriction of the result to the space of invariant polynomials. In [26] Noumi generalized the construction for the (Cn∨,Cn) case which allowed to obtain commutative algebra containing the Koornwinder operator [21]. In order to obtain generalized Macdonald-Ruijsenaars systems we first specialize DAHA-invariant ideals in the polynomial representation, these ideals consist of functions vanishing on certain collections of planes. Then the action of the invariant combinations of Cherednik-Dunkl operators is defined on the functions on these planes. Upon restriction to Weyl group invariants we obtain commutative algebras of difference operators. In this way we recover operator (1.2) (under assumption that ℏ/η∈Z) for the case of DAHA of type A and derive further known and new generalized Macdonald-Ruijsenaars operators starting from other root systems. Similar approach to the generalized Calogero-Moser systems was developed by one of the authors in [13]. It is based on finding special ideals invariant under the rational Cherednik algebras with subsequent restriction of invariant combinations of Dunkl operators thus generalizing Heckmanʼs construction of the usual Calogero-Moser systems [16]. The idea to describe submodules of the polynomial representations of DAHAs by vanishing conditions was very successfully used by Kasatani in [18,19] (see also discussion in the introduction of [10] where the polynomial representation is studied from another perspective). Thus in the work [18] a filtration of the polynomial representation in type A by the ideals given by vanishing ("wheel") conditions was introduced so that it provides composition factors of the polynomial module (see also [11]). The paper [19] deals with the polynomial representation of DAHA associated to the affine root system (Cn∨,Cn). Ideals in the ring of symmetric polynomials invariant under the Macdonald-Ruijsenaars operator (1.1) were earlier defined by wheel conditions in [15]. Submodules in the polynomial representations exist at special relations between parameters of the DAHAs. Therefore the generalized Macdonald-Ruijsenaars operators which we obtain carry these restrictions. This is different from the type A construction of [29] where the authors work in the space of symmetric functions in infinitely many variables and consider some invariant ideals in that algebra. Nevertheless, for the classical series of root systems one can consider polynomial representations for different ranks of root systems and the respective invariant submodules so that the resulting operators coincide. That is one obtains operators at some integral restriction on the parameters but the corresponding integral values can be chosen arbitrarily and the operators do not depend on these values. This allows to omit these restrictions and to continue the commuting families of the resulting operators into the general parameters. In type An this leads to the operator (1.2) and its quantum integrals. In type (Cn∨,Cn) this leads to the generalizations of Koornwinder and van Diejen operators. The structure of the paper is as follows. In Section 2 we recall Cherednikʼs construction of the commutative algebra of difference operators using DAHA of type Rˆ. In Section 3 we introduce arrangements of planes D corresponding to subsets S0 of the set of simple roots of the root system R and we define ideals of functions ID vanishing on these planes. Our first main result (Theorem 3.3) states that for the special geometry of S0 and for the related choice of parameters for DAHA the ideals ID are DAHA-invariant. The arising arrangements D are shifted versions of the linear arrangements appearing in the study of invariant ideals for the rational Cherednik algebras [13]. In Section 3.4 we construct further invariant ideals given by vanishing conditions where we allow parallel planes. This generalizes construction of such ideals for DAHA for classical root systems from [18,19]. In Section 4 we present our next main result (Theorem 4.1) which explains how commutative algebras of difference operators arise in the quotients of the polynomial representations by the above ideals ID. We show in Section 4.2 that these algebras contain complete sets of algebraically independent operators. We verify in Section 4.3 that in type A we obtain operators (1.2). We also construct explicitly a complete set of commuting operators for (1.2) (Theorem 4.5). We consider further examples illustrating the approach in Sections 4.4, 4.5. Thus we demonstrate that starting from the Macdonald operator of type B we obtain trigonometric version of the operators known from [30,12]. Subsystems in the exceptional root systems provide new families of commutative algebras, we demonstrate this by getting a restricted operator starting from the Macdonald operator for the root system R=F4. In Section 5 we extend our constructions for the (Cn∨,Cn) DAHA. We specify invariant ideals in the polynomial representation by imposing vanishing condition on suitable arrangements of planes (Theorem 5.2). These submodules correspond to the intersections of the submodules investigated in [19]. We introduce generalized Koornwinder operator and derive it as a restriction of the Koornwinder operator in Propositions 5.4, 5.5. This operator depends on six parameters like the original Koornwinder operator, and also it reflects that there are interacting particles of two types. Although the restriction construction imposes some integrality relation(s) on the parameters we show that the operator can be embedded into a large commutative algebra of difference operators for any values of the parameters. In Theorem 5.7 we find a complete set of quantum integrals in the explicit form. This generalizes van Diejenʼs quantum integrals for the Koornwinder operator [31]. In Section 6 we present our constructions for DAHA of type Rˆ∨ [5]. The invariant ideals are specified in Theorem 6.1. 