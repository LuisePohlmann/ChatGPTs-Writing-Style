An integral contravariant formulation of the fully non-linear Boussinesq equations  Abstract In this paper we propose an integral form of the fully non-linear Boussinesq equations in contravariant formulation, in which Christoffel symbols are avoided, in order to simulate wave transformation phenomena, wave breaking and nearshore currents in computational domains representing the complex morphology of real coastal regions. Following the approach proposed by Chen (2006), the motion equations retain the term related to the approximation to the second order of the vertical vorticity. A new Upwind Weighted Essentially Non-Oscillatory scheme for the solution of the fully non-linear Boussinesq equations on generalised curvilinear coordinate systems is proposed. The equations are rearranged in order to solve them by a high resolution hybrid finite volume-finite difference scheme. The conservative part of the above-mentioned equations, consisting of the convective terms and the terms related to the free surface elevation, is discretised by a high-order shock-capturing finite volume scheme in which an exact Riemann solver is involved; dispersive terms and the term related to the approximation to the second order of the vertical vorticity are discretised by a cell-centred finite difference scheme. The shock-capturing method makes it possible to intrinsically model the wave breaking, therefore no additional terms are needed to take into account the breaking related energy dissipation in the surf zone. The model is verified against several benchmark tests, and the results are compared with experimental, theoretical and alternative numerical solutions. Highlights • We propose a contravariant formulation of the fully non-linear Boussinesq equations. • The presented contravariant formulation is free of Christoffel symbols. • The equations retain the approximation to the second order of the vertical vorticity. • We present a new Upwind Weighted Essentially Non-Oscillatory scheme. • The shock-capturing scheme allows an explicit simulation of the wave breaking.  Introduction The modelling of surface wave transformation phenomena in coastal regions and breaking waves are of fundamental importance for the simulation of the surf zone hydrodynamics. The two-dimensional Boussinesq equations make it possible to represent most of the above-mentioned phenomena. These equations arise from the depth integration of the Euler equations once the depth dependence of the variables is known. The standard Boussinesq equations are based on the assumption of linear distribution over the depth of the vertical component of the velocity and encompass frequency dispersion by taking into account the effects of the vertical acceleration on the pressure vertical distribution. The most common forms of the standard Boussinesq equations include the lowest order of both frequency dispersion and non-linearities and are able to adequately represent wave phenomena only in a range of values of the water depth, h0, to deep water wave length, L0, ratio up to 0.2. Madsen and Sørensen (1992) proposed an extended form of the Boussinesq equations, expressed in function of the depth averaged velocity, which allowed the representation of wave phenomena even in regions where the h0/L0 ratio is close to 0.5. By introducing an additional third order term, which can be thought as a slight modification of the Padé approximant of the full dispersive relation, in the depth integrated momentum equation, Madsen and Sørensen (1992) improved the dispersion properties of the Standard Boussinesq equations. Nwogu (1993) derived an alternative form of the extended Boussinesq equations in which the dependent variable was the velocity at an arbitrary distance from the still water level. Nwogu (1993) improved the linear dispersion properties of the standard Boussinesq equations retaining terms up to O(ε) and O(μ2) in variable depth power expansion, where ε=a0/h0 and μ=h0/L0 are non-dimensional parameters related to the order of magnitude of non-linearities and frequency dispersion and a0 is the deep water wave amplitude. Nwogu (1993) included an additional frequency dispersion term in the continuity equation and improved, compared to the Standard Boussinesq equations, the representation of the dispersion phenomena in intermediate and deep water. Wei et al. (1995) followed the Nwogu (1993) approach using the velocity at a certain depth as a dependent variable. They derived a fully non-linear extension of the Boussinesq equations by retaining terms up to O(μ2) and O(εμ2) in variable depth power expansion and consequently improved the accuracy of the model just seaward of the surf zone where the wave height to water depth ratio is essentially equal to 1. Chen et al. (1999) used a model based on the fully non-linear extended Boussinesq equations proposed by Wei et al. (1995) in order to simulate wave phenomena and breaking-induced nearshore circulation. They modelled the wave breaking and energy dissipation in the surf zone by introducing an eddy viscosity term into the governing momentum equation. Velocity and free surface elevation fields obtained by numerical integration of the above-mentioned Boussinesq equations were averaged in time and gave the possibility to predict longshore and rip currents and to simulate the coupled interaction of surface waves and currents. Chen et al. (2003) improved the above-mentioned model by introducing an additional term in the momentum equation in order to ensure the property of vertical vorticity conservation and to improve the simulation of surface waves and longshore currents. Chen et al. (2003) started from the three-dimensional Euler equations in which the convective terms were explicitated directly in terms of vector product between velocity and vorticity. The introduction in the above-mentioned Euler equations of the vertical distribution of the velocity and pressure, obtained by retaining terms up to O(εμ2) and O(μ2) in depth power expansion, and of the vertical component of the vorticity gave a new form of the Boussinesq type momentum equation for the partially rotational motion. The vertical vorticity conservation is correct to the second order consistently with the order of approximation for the wave motion. Erduran et al. (2005) proposed a method for the solution of the extended Boussinesq equations, in the form proposed by Madsen and Sørensen (1992), based on a hybrid scheme consisting of finite volume and finite difference procedures. The governing equations were rearranged to obtain a conservative part that can be treated by a finite volume method. The remaining terms in the depth averaged momentum equation were considered as source and sink terms and discretised by a finite difference method. The presence of the dispersive terms in the Boussinesq equations balances the amplitude dispersion phenomenon and makes the wave fronts stable. For this reason the Boussinesq equations are not able to automatically and intrinsecally represent shallow water wave breaking. Many authors introduce breaking dissipation schemes in the Boussinesq equations which have to be applied in the surf zone. Zelt (1991), Karambas and Koutitas (1992) and Kennedy et al. (2000) provide a wave breaking model in the form of an eddy viscosity term added to the momentum equation. This term takes into account the energy dissipation due to the wave breaking induced turbulence. Different methods are based on the surface roller concept introduced by Svendsen (1984): the underlying idea is that the surface roller can be considered as a volume of water carried by the wave. In the wave breaking model proposed by Schäffer et al. (1993) and Madsen et al. (1997), the roller propagates with the wave celerity and the velocity below the roller is obtained from the irrotational theory. This leads to additional terms in the momentum equation and consequently in an increase of momentum flux which simulates wave breaking. By the consideration that in the surf zones, the wave breaking induced energy dissipation is substantially related to the breaking generated vorticity, Svendsen et al. (1996), Veeramony and Svendsen (2000) and Musumeci et al. (2005) solved the vorticity transport equation in order to simulate the vorticity vertical distribution. In the above-mentioned models the dissipation term due to the wave breaking is related to the presence of the vorticity. As the weak solutions of the integral form of the motion equations (numerically solved by a shock-capturing scheme) are able to directly simulate wave breaking, the explicit introduction in the equations of terms representing the breaking wave dissipation is not necessary. Shock-capturing schemes permit an explicit simulation of the wave breaking phenomenon, thus these schemes do not require any empirical calibration. Hybrid methods have been recently used by many authors in order to take advantage of the shock capturing methods in simulating breaking waves. Tonelli and Petti (2009) extended the hybrid scheme proposed by Erduran et al. (2005) to the two-dimensional Madsen and Sørensen (1992) equations seaward of the surf zone and implemented a shock-capturing method for the solution of the non-linear shallow water equations in the surf zone: the Riemann problem was solved by an approximated HLL solver and a MUSCL-TVD technique was used for fourth order reconstructions. Roeber et al. (2010) solved Nwogu's (1993) one-dimensional equations by a hybrid scheme including a shock capturing method based on a Godunov-type procedure; they introduced an eddy viscosity term into the governing equation in order to control the instabilities produced by the sharp gradients of transport quantities. Shi et al. (2012) modified the fully non-linear Boussinesq equations proposed by Chen (2006) by introducing a moving reference level, presented for the first time by Kennedy et al. (2001), in order to optimise the non-linear behaviour of the resulting model equations. The governing equations were written in conservative form with an approximated Riemann solver and a MUSCL technique being used. Shi et al. (2012) followed the Tonelli and Petti (2009) approach in modelling wave breaking: the Boussinesq equations switched into the non-linear shallow water equations where the Froude number exceeds a certain threshold. In this paper a new integral form of the fully non-linear Boussinesq equations in contravariant formulation is proposed in order to simulate wave evolution, wave breaking and breaking-induced nearshore currents in computational domains representing the complex morphology of real coastal regions. Following the approach proposed by Chen (2006), motion equations retain the term related to the second order vertical vorticity. Breaking wave propagation in the surf zone is simulated with a high-order shock-capturing scheme: an exact Riemann solver and a WENO reconstruction technique are used. The computation of flows over domains representing the complex morphology of real cases can be carried out using two different strategies. The first of these strategies is based on the use of unstructured grids (Hu and Shu (1999), Petti and Bosa (2007), Mandal and Rao (2011), Sørensen et al. (2004), Arminjon and St-Cyr (2003), Gallerano and Napoli (1999), Gallerano et al. (2005), Titarev and Drikakis (2011), Cioffi et al. (2005)). The second of these strategies is based on the use of computational cells that result from the intersection of curvilinear boundary conforming coordinate lines. By adopting the latter strategy the motion equations can be expressed in contravariant formulation (Luo and Bewley (2004), Gallerano and Cannata (2011a), Rossmanith et al. (2004), Wesseling et al. (1999), Zijlema et al. (1995), Segal et al. (1992)). In numerical solutions of motion equations in contravariant formulation, a contradiction related to the presence of Christoffel symbols appears. It is well known that non-conservative forms of the convective terms present in the conservation laws do not permit numerical methods for the solution of the above-mentioned laws to converge to weak solutions. Consequently the integration of the conservation laws in the solutions of which shocks are present, requires convective terms to be expressed in conservative form. The contravariant formulation of motion equations involves covariant derivatives that give rise to Christoffel symbols. These terms are extra source terms. They come in with the variability of base vectors and do not permit the definition of convective terms in a conservative form. Furthermore, computational errors can be produced by numerical discretisation of the Christoffel symbols on highly distorted grids and the numerical accuracy can be reduced. Consequently the contravariant fully non-linear Boussinesq equations, numerically integrated on generalised boundary conforming curvilinear grids, must be free of Christoffel symbols. In this work a new Upwind Weighted Essentially Non-Oscillatory scheme is proposed for the solution of the fully non-linear Boussinesq equations. A new integral form for this set of equations expressed directly in contravariant formulation is presented. In order to avoid Christoffel symbols, the contravariant form of the motion equations is integrated on an arbitrary surface and is resolved in the direction identified by a constant parallel vector field. In this way we present an integral form of the contravariant fully non-linear Boussinesq equations in which Christoffel symbols are avoided. The equations are solved by a hybrid finite volume-finite difference scheme. Convective terms and terms related to the free surface elevation gradient are discretised by a high order finite volume upwind WENO scheme; dispersive terms and the term related to the second order vertical vorticity are discretised by a finite-difference scheme. The upwind WENO scheme needs a flux calculation at the cell interfaces. These fluxes are calculated by means of the solution of a Riemann problem. An Exact Riemann Solver is used in this work. No additional dissipative term to improve the modelling of breaking related energy decay and breaking induced nearshore circulation is used in this paper. The paper is organised as follows: the conservative form of the Cartesian fully non-linear Boussinesq equations is presented in Section 2; the integral form of the contravariant fully non-linear Boussinesq equations is presented in Section 3; Section 4 shows the numerical scheme used to solve the equations; in Section 5 accuracy tests and applications to problems of wave breaking and nearshore currents are presented and conclusions are made in Section 6. 